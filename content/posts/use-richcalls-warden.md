---
title: "使用 RichCalls Warden"
date: 2024-08-06T12:58:00+08:00
tags: ["RichCalls", "Warden", "美股"]
draft: false
toc: true
---

## 引言

Warden 是我开发的一套用于帮我们美股止盈/止损的工具，它可以帮助你在美股交易中更好的控制风险。帮助你守住利润，避免亏损。

官网是 <https://warden.richcalls.xyz/>，使用 Google 账号登录即可使用。目前内测版本，内测期间免费使用。


## 配置账户

登录之后在菜单栏选择「账户管理」，然后添加账户就可以了。目前只支持长桥证券和富途证券。而且只支持美股。


<!--more-->

### 长桥证券

长桥访问 <https://open.longportapp.com/> 登录之后去个人中心获取 API Key 和 Secret 等信息，然后填写到 Warden 中即可使用了。

![](https://img.forecho.com/20qUdi.png)

### 富途证券

由于富途证券的 API 的使用方式问题，这里想使用富途证券的用户配置好信息之后，需要联系我，我需要手动另外在配置一下才能使用。

需要说明的是：

- 配置的时候需要输入登录密码的 MD5 值，可以使用 [https://www.cmd5.com/](https://www.cmd5.com/) 获取到密码 MD5 加密之后的值，复制过来就可以（如下图）。
![](https://img.forecho.com/iR7yhd.png)

- 解锁密码要输入明文密码，不需要 MD5 加密。

### 账户使用说明

账户默认是开启状态，并且开启了 Test Mode（测试模式）。测试模式，开启之后会无视市价单，所有的订单买入的时候提交的是 0.01 ,卖出的时候是  999.00 的限价单。这样可以避免在测试的时候买入卖出真实的股票。

测试之后可以关闭测试模式，这样就可以正常的买入卖出股票了。

Webhook 请求只会处理 `Active` 状态的账户，如果你不想使用某个账户了，可以在账户管理中关闭这个账户。

## 系统使用说明

### 结合 TradingView 实现自动交易

这是本系统的核心功能，你可以在 [TradingView](https://link.3li3.com/tradingview) 上配置警报，然后在 Warden 中配置好账户之后，就可以实现自动交易了。

具体步骤：

先去 Warden 系统的个人设置中获取到你的 `WebHook Url`，这个 Url 是用来接收 TradingView 的警报的。不要泄露给别人。


然后在 TradingView 中配置警报，在「通知」中填写你的 `WebHook Url`，然后就可以了。

![](https://img.forecho.com/ZBrmfw.png)

说明一下：

- 图上的条件就是你的策略，这里可玩性非常多，你可以自己划线，然后创建报警；你也可以使用 MA、EMA、BOLL 等指标来创建报警。至于怎么玩，完全取决于你的策略。
- 消息需要是 Warden 系统的一种固定格式，你需要做什么操作，完全取决于你的消息内容。
- WebHook Url 是你的 Warden 系统的 Url，不要泄露给别人。

### WebHook 消息格式说明

```
symbol: NVDA240823C115000
pos: 1
qty: 1
side: BUY
order_type: LO
price: 0
```

- `symbol` 股票或者期权，必选参数；在卖出的时候，期权代码支持模糊匹配。示例：
    - `NVDA240823C115000` 代表想操作 NVDA 2024 年 8 月 23 日到期的 115 美元的 Call 期权。
    - `NVDA*` 代表想卖出所有的持仓期权，只能搭配市价单和卖出使用。
    - `*` 代表清仓，需搭配市价单和卖出使用。
- `pos` 仓位占比，卖出的时候可选参数; 当有此参数的时候会忽略 `qty` 参数，示例：
    - `1` 代表卖出全部持仓，
    -  `1/2` 代表卖出一半持仓，
    - `1/3` 代表卖出三分之一仓位。
- `qty` 数量，必选参数，除卖出有 `pos` 参数外，其他都需要此参数
- `side` 方向
	- `buy` 买入
	- `sell` 卖出
- `order_type` 订单类型
	-  `lo` 限价单
	-  `mo` 市价单
- `price` 价格，市价单会忽略此参数。

另外说明：

- 所有参数无视大小写
- 所以订单都是当日有效
- 目前只支持美股，不支持其他市场

### 期权计算器

为了方便大家获取到期权的标的代码，我在系统中加入了期权计算器，你可以输入你想要的期权的条件，然后就可以很方便的获取到期权的标的代码了，方便你在 TradingView 中配置警报的时候使用。

![](https://img.forecho.com/JEAEVD.png)

### 一键清仓

除了给系统发消息实现一件清仓之外，我在账户管理中加入了一键清仓的功能，你可以直接在账户管理中点击一键清仓，就可以清仓所有的持仓了。

当然清仓之前会有一个确认的弹窗，避免误操作。

### 定时交易

还在开发中，敬请期待。

## 最佳实践

这套系统最主要的目的是给大家做止盈止损的，有时候我们明明知道跌破了支撑，但是却缺乏执行力，怎么办？提前设置好止损，然后就可以放心的等待系统帮你卖出了。

比如下面一些场景

### 一键清仓

QQQ 如果跌破 MA20，那么其实就是一个非常糟糕的信号，这个时候一般还会继续跌，有时候你可能会犹豫，下不去手清仓，这个时候我们需要在 TradingView 中提前设置好警报，然后 Warden 就会帮你卖出了。

如果你想一键清仓，消息的格式就是：

```
symbol: *
pos: 1
side: sell
order_type: mo
```

如果你想所有的持仓都卖出一半，那么消息的格式就是：

```
symbol: *
pos: 1/2
side: sell
order_type: mo
```

除了使用 `*` 代表清仓，还可以使用 `NVDA*` 代表清仓 NVDA 的所有正股和期权。

除了使用 QQQ 跌破 MA20 作为清仓信号，你还可以使用其他的指标，比如 SPX 跌破某个值等等。

### Webhook 日志

在系统中有一个 Webhook 日志，你可以看到系统接收到的消息，以及处理的结果。这样你就可以知道系统是否正常的接收到了消息，以及是否正常的处理了消息。

## 最后

这套系统还在不断的完善中，如果你有什么好的建议或者想法，欢迎加我微信 `ipzone` 加项目群交流，申请加好友请备注 `Warden`。
