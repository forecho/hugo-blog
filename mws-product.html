<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=generator content="Hugo 0.82.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Saber v0.11.2"><meta name=author content="forecho"><meta name=keywords content="yii2,yii,炒美股,如何炒美股,美股入金 php,ios,ruby,python,swift,web development"><meta name=og:site_name content="forecho's Blog"><meta property="og:type" content="article"><meta property="title" content="MWS 开发 - 产品上传篇 - forecho's Blog"><meta property="og:title" content="MWS 开发 - 产品上传篇 - forecho's Blog"><meta property="twitter:title" content="MWS 开发 - 产品上传篇 - forecho's Blog"><meta name=description content="引言
上次我们讲了 MWS 与订单相关的开发，这次我们就来讲如何通过 MWS 接口上传产品。"><meta property="og:description" content="引言
上次我们讲了 MWS 与订单相关的开发，这次我们就来讲如何通过 MWS 接口上传产品。"><meta property="twitter:description" content="引言
上次我们讲了 MWS 与订单相关的开发，这次我们就来讲如何通过 MWS 接口上传产品。"><meta property="og:type" content="article"><title>MWS 开发 - 产品上传篇 - forecho's Blog</title><meta property="og:url" content="https://blog.forecho.com/mws-product.html"><meta property="og:image" content="https://avatars0.githubusercontent.com/u/1725326?s=460&v=4"><meta property="twitter:image" content="https://avatars0.githubusercontent.com/u/1725326?s=460&v=4"><link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/1725326?s=460&v=4" type=image/x-png><link rel=stylesheet href=/css/main.min.0390f7612b23c0f8371b7fde0b1409eabff7fc4d7bd4c6cbdf9fbb71ceea5484.css integrity=sha256-A5D3YSsjwPg3G3/eCxQJ6r/3/E171MbL35+7cc7qVIQ=><link rel=stylesheet href=//at.alicdn.com/t/font_1607597_jhmihcvh0tm.css><link href=/index.xml rel=alternate type=application/rss+xml title="forecho's Blog"><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=google-site-verification content="OMI81_SJiESxwq-Fr0CLleoF7EzVdRx7QTQlbAfCVdI"><meta name=sogou_site_verification content="5AsiT3lHig"><meta name=baidu-site-verification content="WuHyHeOJtJ"></head><body class="bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 tracking-wider leading-normal"><nav id=header class="bg-white dark:bg-black fixed w-full z-10 top-0 shadow"><div id=progress class="h-1 z-20 top-0" style="background:linear-gradient(to right,#4dc0b5 var(--scroll),transparent 0)"></div><div class="w-full container mx-auto flex flex-wrap items-center justify-between my-1"><div class=pl-4><a class="text-base no-underline hover:no-underline font-bold text-xl" href=/>forecho's Blog</a></div><div class="block lg:hidden pr-4"><button id=nav-toggle class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-900 hover:border-teal-500 appearance-none focus:outline-none"><svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg></button></div><div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 bg-gray-100 dark:bg-black md:bg-transparent z-20" id=nav-content><ul class="list-reset lg:flex justify-end flex-1 items-center"><li class=mr-3><a href=/ class="inline-block py-2 px-2 text-gray-700 dark:text-gray-300 font-bold no-underline">首页</a></li><li class=mr-3><a href=/posts.html class="inline-block py-2 px-2 text-gray-700 dark:text-gray-300 font-bold no-underline">文章归档</a></li><li class=mr-3><a href=https://stock.forecho.com/ class="inline-block py-2 px-2 text-gray-700 dark:text-gray-300 font-bold no-underline">美股开户</a></li><li class=mr-3><a href=/about.html class="inline-block py-2 px-2 text-gray-700 dark:text-gray-300 font-bold no-underline">关于我</a></li><li class=mr-3><a href=/friendship-links/ class="inline-block py-2 px-2 text-gray-700 dark:text-gray-300 font-bold no-underline">联盟链接</a></li><button id=switchTheme class="h-10 w-10 flex justify-center items-center focus:outline-none"><div id=dark-icon class=hidden><svg fill="none" stroke="currentcolor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6"><title>Dark Mode</title><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg></div><div id=light-icon><svg fill="none" stroke="currentcolor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6"><title>Light Mode</title><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div></button></ul></div></div></nav><div id=container class="container w-full flex flex-wrap mx-auto px-2 lg:pt-12 mt-10"><section class="w-full lg:w-3/4 xl:w-3/4"><div class="px-8 py-6 mt-6 lg:mt-0 leading-normal rounded shadow bg-white dark:bg-black"><div><h1 class="font-bold break-normal text-gray-800 pt-2 pb-2 text-2xl lg:text-3xl dark:text-white"><a href=https://blog.forecho.com/mws-product.html title="MWS 开发 - 产品上传篇">MWS 开发 - 产品上传篇</a></h1><p class="mb-1 text-sm text-gray-500 dark:text-gray-300"><span title=" 2019-08-08 22:58:00 +0800"><i class="iconfont icon-calendar" aria-hidden=true></i> 08 Aug 2019</span>
<span class="hidden xl:inline-block">|
<i class="iconfont icon-book"></i>
1878 字</span>
<span class="hidden xl:inline-block">|
<i class="iconfont icon-clock-o"></i>
4 分钟读完</span></p></div><div class="md:hidden dark:text-gray-100"><p class="text-base font-bold py-2 yg:pb-6 text-gray-700 dark:text-gray-300">文章目录</p><div class="sticky text-sm" style=top:6em id=menu-content><nav id=TableOfContents><ul><li><a href=#引言>引言</a></li><li><a href=#上传产品>上传产品</a><ul><li><a href=#思路>思路</a></li><li><a href=#实现>实现</a></li></ul></li><li><a href=#注意事项>注意事项</a><ul><li><a href=#编码问题>编码问题</a></li><li><a href=#产品图片>产品图片</a></li><li><a href=#upcean>UPC/EAN</a></li><li><a href=#关于产品描述>关于产品描述</a></li><li><a href=#sku-异常>SKU 异常</a></li></ul></li><li><a href=#总结>总结</a></li><li><a href=#相关文章>相关文章</a></li></ul></nav></div></div><div class="post-content dark:text-white"><h2 id=引言>引言</h2><p>上次我们讲了 <a href=https://blog.forecho.com/mws-order.html>MWS 与订单相关的开发</a>，这次我们就来讲如何通过 MWS 接口上传产品。</p><h2 id=上传产品>上传产品</h2><p>上传产品有几种方式，此处我们采用的是提交类型为 <a href=https://docs.developer.amazonservices.com/en_US/feeds/Feeds_FeedType.html><code>_POST_FLAT_FILE_LISTINGS_DATA_</code></a> 的 Feed 方式来上传产品。因为这种方式兼容性比较强。</p><h3 id=思路>思路</h3><p>思路就是先生成一个包含产品信息的 csv 文件，再去请求 MWS 接口。</p><h3 id=实现>实现</h3><p><a href=https://blog.forecho.com/mws-order.html>《订单篇》</a>我有提到一个 MWS PHP 的库，但是再开发产品上传功能的时候，被这个库坑惨了，由于作者不维护了，即使提了 PR 也没人合并，所以我 Fork 了一份，自己直接改了代码，修复了 bug，欢迎你们使用我的这个库 <a href=https://github.com/forecho/amazon-mws>forecho/amazon-mws</a>。</p><p><strong>安装库</strong></p><p>使用方式，先修改你项目的 <code>composer.json</code> 文件，添加如下代码</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>&#34;require&#34;: {
    // ...
    &#34;mcs/amazon-mws&#34;: &#34;*&#34;,
    // ...
},
&#34;repositories&#34;: [
    {
        &#34;name&#34;: &#34;mcs/amazon-mws&#34;,
        &#34;type&#34;: &#34;git&#34;,
        &#34;url&#34;: &#34;git@github.com:forecho/amazon-mws.git&#34;
    }
]
</code></pre></td></tr></table></div></div><p>然后再执行如下命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>composer require mcs/amazon-mws
</code></pre></td></tr></table></div></div><blockquote><p>如果在执行命令行的时候提示需要输入 <code>Token</code> 的话，解决办法就是去 GitHub 的 <a href=https://github.com/settings/tokens>Personal access tokens</a> 页面，点击 「Generate new token」 新建一个 Token，选择 <code>public_repo</code> ，然后就会得到一个 Token，然后去终端输入这个值就可以继续了。</p></blockquote><p>原来的库上传产品非常简单，更是没有提供 <code>_POST_FLAT_FILE_LISTINGS_DATA_</code> 的方式上传产品，我在这个 issue#30 - <a href=https://github.com/meertensm/amazon-mws/issues/30>Add Product Error</a> 的基础上加了此功能。</p><p><strong>上传产品的伪代码</strong></p><p>下面是我上传产品的伪代码，可以拿来参考：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#ff79c6>&lt;?</span>php
<span style=color:#ff79c6>public</span> <span style=color:#ff79c6>function</span> <span style=color:#50fa7b>uploadAmazon</span>(string <span style=color:#8be9fd;font-style:italic>$productType</span>, Product <span style=color:#8be9fd;font-style:italic>$product</span>, int <span style=color:#8be9fd;font-style:italic>$productNode</span>, <span style=color:#8be9fd;font-style:italic>$otherAttributes</span> <span style=color:#ff79c6>=</span> []) 
{
    <span style=color:#8be9fd;font-style:italic>$client</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> MCS\MWSClient([
        <span style=color:#f1fa8c>&#39;Marketplace_Id&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;&#39;</span>,
        <span style=color:#f1fa8c>&#39;Seller_Id&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;&#39;</span>,
        <span style=color:#f1fa8c>&#39;Access_Key_ID&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;&#39;</span>,
        <span style=color:#f1fa8c>&#39;Secret_Access_Key&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;&#39;</span>,
        <span style=color:#f1fa8c>&#39;MWSAuthToken&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;&#39;</span> <span style=color:#6272a4>// Optional. Only use this key if you are a third party user/developer
</span><span style=color:#6272a4></span>    ]);
    <span style=color:#8be9fd;font-style:italic>$amazonProducts</span> <span style=color:#ff79c6>=</span> [];
    <span style=color:#8be9fd;font-style:italic>$postItems</span> <span style=color:#ff79c6>=</span> [];
    <span style=color:#8be9fd;font-style:italic>$amazonProduct</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> AmazonMarketPlaceProduct();
    <span style=color:#ff79c6>if</span> (<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>productSku</span>) {
        <span style=color:#8be9fd;font-style:italic>$amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSku</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>parent_sku</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setFeedProductType</span>(<span style=color:#8be9fd;font-style:italic>$productType</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setBrand</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>brand</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setTitle</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>title</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setManufacturer</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>manufacturer</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setRecommendedBrowseNodes</span>(<span style=color:#8be9fd;font-style:italic>$productNode</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setParentChild</span>(<span style=color:#f1fa8c>&#39;Parent&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setOtherAttributes</span>(\app\core\helpers\ArrayHelper<span style=color:#ff79c6>::</span><span style=color:#50fa7b>clearValue</span>(<span style=color:#8be9fd;font-style:italic>$otherAttributes</span>))
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setVariationTheme</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>variation_theme</span>);
        array_push(<span style=color:#8be9fd;font-style:italic>$amazonProducts</span>, <span style=color:#8be9fd;font-style:italic>$amazonProduct</span>);
        array_push(<span style=color:#8be9fd;font-style:italic>$postItems</span>, <span style=color:#8be9fd;font-style:italic>$amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>toArray</span>(<span style=color:#ff79c6>false</span>));

        <span style=color:#ff79c6>foreach</span> (<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>productSku</span> <span style=color:#ff79c6>as</span> <span style=color:#8be9fd;font-style:italic>$productSku</span>) {
            <span style=color:#8be9fd;font-style:italic>$retailPrice</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>retail_price</span> <span style=color:#ff79c6>?:</span> <span style=color:#bd93f9>0</span>;
            <span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>sale_price</span> <span style=color:#ff79c6>?:</span> <span style=color:#bd93f9>0</span>;
            <span style=color:#8be9fd;font-style:italic>$saleDate</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>?</span> explode(<span style=color:#f1fa8c>&#39;~&#39;</span>, <span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>sale_date</span>) <span style=color:#ff79c6>:</span> [];

            <span style=color:#8be9fd;font-style:italic>$_amazonProduct</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>clone</span> <span style=color:#8be9fd;font-style:italic>$amazonProduct</span>;
            <span style=color:#8be9fd;font-style:italic>$_amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSku</span>(<span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>product_sku</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setFeedProductType</span>(<span style=color:#8be9fd;font-style:italic>$productType</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setBrand</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>brand</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setTitle</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>title</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setManufacturer</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>manufacturer</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setPrice</span>(<span style=color:#8be9fd;font-style:italic>$retailPrice</span> <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>?</span> CurrencyConverter<span style=color:#ff79c6>::</span><span style=color:#50fa7b>CNYConverter</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>, <span style=color:#8be9fd;font-style:italic>$retailPrice</span>) <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSalePrice</span>(<span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>?</span> CurrencyConverter<span style=color:#ff79c6>::</span><span style=color:#50fa7b>CNYConverter</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>, <span style=color:#8be9fd;font-style:italic>$salePrice</span>) <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setProductId</span>(<span style=color:#8be9fd;font-style:italic>$amazonProductId</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSizeName</span>(<span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>size</span> <span style=color:#ff79c6>?:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setColorName</span>(<span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>color</span> <span style=color:#ff79c6>?:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setProductIdType</span>(<span style=color:#f1fa8c>&#39;EAN&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setCurrency</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setConditionType</span>(<span style=color:#f1fa8c>&#39;New&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setWeight</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>weight</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setQuantity</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>quantity</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setParentChild</span>(<span style=color:#f1fa8c>&#39;Child&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setParentSku</span>(<span style=color:#8be9fd;font-style:italic>$parentSku</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSaleFromDate</span>(count(<span style=color:#8be9fd;font-style:italic>$saleDate</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>?</span> <span style=color:#8be9fd;font-style:italic>$saleDate</span>[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSaleEndDate</span>(count(<span style=color:#8be9fd;font-style:italic>$saleDate</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>?</span> <span style=color:#8be9fd;font-style:italic>$saleDate</span>[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setVariationTheme</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>variation_theme</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setKeywords</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>search_keyword</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setRecommendedBrowseNodes</span>(<span style=color:#8be9fd;font-style:italic>$productNode</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setBulletPoint</span>(<span style=color:#8be9fd;font-style:italic>$features</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setDescription</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>description</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setOtherAttributes</span>(<span style=color:#8be9fd;font-style:italic>$otherAttributes</span>)
                <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setImage</span>(<span style=color:#8be9fd;font-style:italic>$productSku</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>images</span>);
            array_push(<span style=color:#8be9fd;font-style:italic>$amazonProducts</span>, <span style=color:#8be9fd;font-style:italic>$_amazonProduct</span>);
            array_push(<span style=color:#8be9fd;font-style:italic>$postItems</span>, <span style=color:#8be9fd;font-style:italic>$_amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>toArray</span>(<span style=color:#ff79c6>false</span>));
        }
    } <span style=color:#ff79c6>else</span> {
        <span style=color:#8be9fd;font-style:italic>$retailPrice</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>price</span> <span style=color:#ff79c6>?:</span> <span style=color:#bd93f9>0</span>;
        <span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>sale_price</span> <span style=color:#ff79c6>?:</span> <span style=color:#bd93f9>0</span>;
        <span style=color:#8be9fd;font-style:italic>$saleDate</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>?</span> explode(<span style=color:#f1fa8c>&#39;~&#39;</span>, <span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>sale_date</span>) <span style=color:#ff79c6>:</span> [];

        <span style=color:#8be9fd;font-style:italic>$amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSku</span>(<span style=color:#8be9fd;font-style:italic>$parentSku</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setFeedProductType</span>(<span style=color:#8be9fd;font-style:italic>$productType</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setBrand</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>brand</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setTitle</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span>{<span style=color:#8be9fd;font-style:italic>$titleAttribute</span>})
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setManufacturer</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>manufacturer</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setPrice</span>(<span style=color:#8be9fd;font-style:italic>$retailPrice</span> <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>?</span> CurrencyConverter<span style=color:#ff79c6>::</span><span style=color:#50fa7b>CNYConverter</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>, <span style=color:#8be9fd;font-style:italic>$retailPrice</span>) <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSalePrice</span>(<span style=color:#8be9fd;font-style:italic>$salePrice</span> <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>?</span> CurrencyConverter<span style=color:#ff79c6>::</span><span style=color:#50fa7b>CNYConverter</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>, <span style=color:#8be9fd;font-style:italic>$salePrice</span>) <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setProductId</span>(<span style=color:#8be9fd;font-style:italic>$amazonProductId</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setProductIdType</span>(<span style=color:#f1fa8c>&#39;EAN&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setCurrency</span>(<span style=color:#8be9fd;font-style:italic>$currency</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setConditionType</span>(<span style=color:#f1fa8c>&#39;New&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setWeight</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>weight</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setQuantity</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>quantity</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSaleFromDate</span>(count(<span style=color:#8be9fd;font-style:italic>$saleDate</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>?</span> <span style=color:#8be9fd;font-style:italic>$saleDate</span>[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setSaleEndDate</span>(count(<span style=color:#8be9fd;font-style:italic>$saleDate</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>?</span> <span style=color:#8be9fd;font-style:italic>$saleDate</span>[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#39;&#39;</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setKeywords</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>search_keyword</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setRecommendedBrowseNodes</span>(<span style=color:#8be9fd;font-style:italic>$productNode</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setBulletPoint</span>(<span style=color:#8be9fd;font-style:italic>$features</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setDescription</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>description</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setOtherAttributes</span>(<span style=color:#8be9fd;font-style:italic>$otherAttributes</span>)
            <span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>setImage</span>(<span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>images</span>);
        array_push(<span style=color:#8be9fd;font-style:italic>$amazonProducts</span>, <span style=color:#8be9fd;font-style:italic>$amazonProduct</span>);
        array_push(<span style=color:#8be9fd;font-style:italic>$postItems</span>, <span style=color:#8be9fd;font-style:italic>$amazonProduct</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>toArray</span>(<span style=color:#ff79c6>false</span>));
    }

    <span style=color:#6272a4>// You can also submit an array of MWSProduct objects
</span><span style=color:#6272a4></span>    <span style=color:#8be9fd;font-style:italic>$feed</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>$client</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>postProduct</span>(
        <span style=color:#8be9fd;font-style:italic>$amazonProducts</span>,
        <span style=color:#f1fa8c>&#39;fptcustomcustom&#39;</span>,
        <span style=color:#f1fa8c>&#39;2019.0501&#39;</span>,
        <span style=color:#f1fa8c>&#39;SE9NRV9MSUdIVElOR19BTkRfTEFNUFM=&#39;</span>
    );
    Yii<span style=color:#ff79c6>::</span><span style=color:#50fa7b>info</span>(<span style=color:#8be9fd;font-style:italic>$postItems</span>, <span style=color:#8be9fd;font-style:italic>$product</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>id</span> <span style=color:#ff79c6>.</span> <span style=color:#f1fa8c>&#39;上传产品数据&#39;</span>);
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>$feed</span>;
}
</code></pre></td></tr></table></div></div><p>上传产品是一个异步接口，提交成功会返回如下数据:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php>[
  <span style=color:#f1fa8c>&#39;FeedSubmissionId&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;xxxxxxx&#39;</span>, <span style=color:#6272a4>// 一串数字
</span><span style=color:#6272a4></span>  <span style=color:#f1fa8c>&#39;FeedType&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;_POST_FLAT_FILE_LISTINGS_DATA_&#39;</span>,
  <span style=color:#f1fa8c>&#39;SubmittedDate&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;2019-08-08T10:15:29+00:00&#39;</span>,
  <span style=color:#f1fa8c>&#39;FeedProcessingStatus&#39;</span> <span style=color:#ff79c6>=&gt;</span> <span style=color:#f1fa8c>&#39;_SUBMITTED_&#39;</span>,
]
</code></pre></td></tr></table></div></div><p>要想获取结果，需要过两分钟之后再去请求另外一个接口，你可以用下面方法实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#8be9fd;font-style:italic>$client</span><span style=color:#ff79c6>-&gt;</span><span style=color:#50fa7b>GetFeedSubmissionResult</span>(<span style=color:#8be9fd;font-style:italic>$FeedSubmissionId</span>);
</code></pre></td></tr></table></div></div><p>如果成功返回的信息是了类似这样的：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>Feed Processing Summary:
	Number of records processed		2
	Number of records successful		2


</code></pre></td></tr></table></div></div><p>如果失败就类似这样的：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>Feed Processing Summary:
	Number of records processed		4
	Number of records successful		3

original-record-number	sku	error-code	error-type	error-message
14	3uC000670-Random combination-Large*2+Sma	90118	Error	The item_sku field contains an invalid value: 3uC000670-Random combination-Large*2+Small*2. The value exceeds the maximum number of bytes allowed: 40.

</code></pre></td></tr></table></div></div><h2 id=注意事项>注意事项</h2><h3 id=编码问题>编码问题</h3><p>我最开始上传产品的时候，产品上传成功了，但是去亚马逊后台看，产品是乱码的，解决这个问题花了我几天时间。导致这个问题出现的原因就是编码问题。</p><p><a href=https://github.com/meertensm/amazon-mws/blob/master/src/MWSClient.php#L1221>meertensm/amazon-mws</a> 提交接口的时候使用的是 <code>iso-8859-1</code> 编码，这意味着上传 CSV 文件的时候，要先把内容转成对应的格式。问题是<strong>并非所有的亚马逊站点都是用这个编码，日本就是用 <code>UTF-8</code> 编码的</strong>，所以之前上传产品到日本站点总算乱码。听说中国站点也是 <code>UTF-8</code> 编码，不过这已经不重要了，因为亚马逊这部分业务已经退出中国了。<strong>此问题我已经在 <a href=https://github.com/forecho/amazon-mws>forecho/amazon-mws</a> 解决</strong>，你可以不用关心此细节。</p><p>另外一个需要注意的编码问题就是，在使用 <code>GetFeedSubmissionResult()</code> 方法获取刊登结果时候，日本站返回的数据是 <code>Shift-JIS</code> 的，这个需要你手动转一下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#ff79c6>if</span> (<span style=color:#8be9fd;font-style:italic>$isJp</span>) {
    <span style=color:#8be9fd;font-style:italic>$string</span> <span style=color:#ff79c6>=</span> mb_convert_encoding(<span style=color:#8be9fd;font-style:italic>$string</span>, <span style=color:#f1fa8c>&#39;UTF-8&#39;</span>, <span style=color:#f1fa8c>&#39;Shift-JIS&#39;</span>)
}
</code></pre></td></tr></table></div></div><h3 id=产品图片>产品图片</h3><p>上传产品的时候图片我们是给的图片地址链接，如果图片放在国内，很容易出现亚马逊下载产品图片超时导致的刊登失败。所以我们要想办法把我们的图片存到海外，比方说使用阿里的 OSS。</p><p>如果因为用了阿里 OSS 的海外 Bucket，导致我们在使用的时候上传图片很慢，可以了解一下这个<a href=https://yq.aliyun.com/articles/688039>《OSS全球传输加速开启公测，助力企业业务全地域覆盖》</a>。</p><h3 id=upcean>UPC/EAN</h3><p>这个可以通过购买生成器生成 UPC 和 EAN，也可以购买合法 UPC/EAN。生成器生成的容易导致上传产品失败，换一个重新上传产品即可。有时候发现你上传的产品出现别人的图片，不要慌，这个就是因为 UPC/EAN 跟别人重复导致的，换一个重新上传产品即可。</p><h3 id=关于产品描述>关于产品描述</h3><p>产品描述除了不能大于 2000 字符串之外，还不能使用除了 <code>&lt;br></code>（换行） 和 <code>&lt;b>&lt;/b></code>（加粗） 之外的 HTML 标签。</p><h3 id=sku-异常>SKU 异常</h3><p>出现上传产品失败，错误信息 SKU 异常的，如 8008 错误，这种情况一般也是因为 UPC/EAN 有问题导致的，我们可以把异常的 SKU 的 UPC/EAN 在 <a href=http://gepir.gs1.org/index.php/search-by-gtin>美国统一代码委员会网站</a> 查询，如果查询到有结果，说明你就不能使用此 UPC/EAN，换一个 UPC/EAN 重新上传即可。</p><h2 id=总结>总结</h2><p>上传产品也是比较核心的功能，开发此功能比我开发同步订单花了更多时间，踩了不少坑，现在分享出来，让大家少走一点弯路。</p><h2 id=相关文章>相关文章</h2><ul><li><a href=https://blog.forecho.com/mws-order.html>《MWS 开发 - 订单篇》</a></li><li><a href=https://blog.forecho.com/mws-product.html>《MWS 开发 - 产品上传篇》</a></li></ul><hr class="bg-gray-300 mt-8"><div class=pt-4><p class=text-center><button id=btn-donate class="px-5 py-2 inline-block rounded hover:bg-red-600 bg-red-400 text-white" for=reward>打赏</button></p><div class="flex-auto mt-2 mx-2 hidden" id=donate-image><div class="w-full px-2 my-2"><div class="bg-white dark:bg-black"><img class="h-48 shadow object-cover w-auto mx-auto" loading=lazy src=https://blog-1251237404.cos.ap-guangzhou.myqcloud.com/20190424153510.png alt=微信打赏><div class="text-center text-gray-500">微信打赏</div></div></div><div class="w-full px-2 my-2"><div class="bg-white dark:bg-black"><img class="h-48 shadow object-cover w-auto mx-auto" loading=lazy src=https://blog-1251237404.cos.ap-guangzhou.myqcloud.com/20190424153431.png alt=支付宝打赏><div class="text-center text-gray-500">支付宝打赏</div></div></div></div></div><div class="border-l-4 border-red-400 mx-auto text-gray-500"><div class=copyright><ul class=list-none><li><strong>原文作者：</strong>
<a rel=author href=https://blog.forecho.com>forecho</a></li><li style=word-break:break-all><strong>原文链接：</strong>
<a href=https://blog.forecho.com/mws-product.html>https://blog.forecho.com/mws-product.html</a></li><li><strong>版权声明：</strong>本作品采用
<a rel=license href=https://creativecommons.org/licenses/by-nc/4.0/deed.zh>署名-非商业性使用 4.0 国际 (CC BY-NC 4.0)</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li></ul></div></div></div><div class="text-base md:text-sm text-gray-500 pt-6"><a class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 hover:bg-gray-300" href=https://blog.forecho.com/tags/mws%E5%BC%80%E5%8F%91.html>#MWS开发</a></div><p class="text-gray-500 text-sm text-right pt-1"><span id=busuanzi_container_page_pv>本文有 <span id=busuanzi_value_page_pv></span>次阅读</span></p></div><hr class="bg-gray-300 dark:bg-gray-300 my-10"><div class=post-ads><div class="p-4 md:hidden rounded shadow bg-white dark:bg-black"><img class="object-cover w-auto mx-auto mt-6" loading=lazy src=https://blog-1251237404.cos.ap-guangzhou.myqcloud.com/20190424153337.png title=微信：ipzone alt=微信：ipzone></div></div><div class=comments><script src=https://utteranc.es/client.js repo=forecho/hugo-blog issue-term=title theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div><div class="p-8 mt-6 lg:mt-0 rounded shadow bg-white dark:bg-black"><h2 class="font-sans font-bold break-normal text-gray-700 px-2 pb-3 text-xl dark:text-gray-300">相关文章</h2><li><a href=/mws-order.html class="underline text-yellow-600">MWS 开发 - 订单篇</a></li><li><a href=/how-does-getyii-prevent-spam.html class="underline text-yellow-600">GetYii 是如何防止垃圾内容</a></li><li><a href=/bose-qc30-vs-airpods.html class="underline text-yellow-600">Bose QC30 VS AirPods</a></li><li><a href=/2019-mid-year-summary.html class="underline text-yellow-600">年中总结</a></li><li><a href=/docker-use-cron.html class="underline text-yellow-600">Docker 使用定时任务</a></li></div></section><div class="hidden xl:text-sm xl:block xl:w-1/4 xl:px-6"><div class="lg:w-full mx-auto items-center justify-between"><div class="bg-white shadow rounded overflow-hidden dark:bg-black"><div class="bg-cover mx-auto w-32 h-32 mt-5 rounded-full" style="background-image:url(https://avatars0.githubusercontent.com/u/1725326?s=460&v=4)"></div><div class=p-4><p class="text-2xl text-center pb-2">forecho</p><p class="text-sm text-center text-gray-700 dark:text-gray-300">把生命浪费在美好的事物上</p></div><div class="flex p-4 border-t text-sm border-gray-300 text-gray-700 dark:text-gray-300"><div class="flex-1 border-r border-gray-600"><p class=text-center><span class=font-bold>395</span>
文章</p></div><div class="flex-1 text-center"><p class=text-center><span class=font-bold>115</span>
标签</p></div></div><div class="px-4 pb-4 border-t border-gray-300 dark:text-gray-200"><div class="mt-6 pb-16 lg:pb-0 w-4/5 lg:w-full mx-auto flex flex-wrap items-center justify-between text-gray-500"><a href=//github.com/forecho class="hover:text-gray-900 dark:hover:text-gray-100 p-1 text-2xl" target=_blank title=GitHub><i class="my-iconfont icon-social-github"></i></a>
<a href=//instagram.com/forecho class="hover:text-gray-900 dark:hover:text-gray-100 p-1 text-2xl" target=_blank title=Instagram><i class="my-iconfont icon-instagram"></i></a>
<a href=//twitter.com/caizhenghai class="hover:text-gray-900 dark:hover:text-gray-100 p-1 text-2xl" target=_blank title=Twitter><i class="my-iconfont icon-social-twitter"></i></a>
<a href=//douban.com/people/ipzone class="hover:text-gray-900 dark:hover:text-gray-100 p-1 text-2xl" target=_blank title=Douban><i class="my-iconfont icon-social-douban"></i></a>
<a href=/atom.xml class="hover:text-gray-900 dark:hover:text-gray-100 p-1 text-2xl" target=_blank title=RSS><i class="my-iconfont icon-feed"></i></a></div></div></div></div><div class="p-4 mt-2 lg:mt-4 rounded shadow bg-white dark:bg-black"><h2 class="font-sans font-bold break-normal text-gray-700 px-2 pb-3 text-lg dark:text-gray-100">热门文章</h2><li><a href=/financedeep-08.html class="underline text-yellow-600 text-sm">【深度理财08】美港股打新哪家强</a></li><li><a href=/take-the-shenzhen-account-in-less-than-3-months.html class="underline text-yellow-600 text-sm">用时不到3个月拿到深圳户口</a></li><li><a href=/how-do-i-invest-in-american-stocks.html class="underline text-yellow-600 text-sm">我是怎么投资美股的</a></li></div><div class=profile-ads><div class="p-4 mt-2 lg:mt-4 rounded shadow bg-white dark:bg-black"><img class="object-cover w-auto mx-auto mt-6" loading=lazy src=https://blog-1251237404.cos.ap-guangzhou.myqcloud.com/20190424153337.png title=微信：ipzone alt=微信：ipzone></div></div><div class="flex flex-col justify-between sticky top-0 pt-12 pb-4 -mt-10 text-gray-600 dark:text-gray-400"><div class="bg-white shadow rounded p-4 mt-5 dark:bg-black"><p class="text-base font-bold py-2 yg:pb-6 text-gray-700 dark:text-gray-300">文章目录</p><div class="sticky text-sm" style=top:6em id=menu-content><nav id=TableOfContents><ul><li><a href=#引言>引言</a></li><li><a href=#上传产品>上传产品</a><ul><li><a href=#思路>思路</a></li><li><a href=#实现>实现</a></li></ul></li><li><a href=#注意事项>注意事项</a><ul><li><a href=#编码问题>编码问题</a></li><li><a href=#产品图片>产品图片</a></li><li><a href=#upcean>UPC/EAN</a></li><li><a href=#关于产品描述>关于产品描述</a></li><li><a href=#sku-异常>SKU 异常</a></li></ul></li><li><a href=#总结>总结</a></li><li><a href=#相关文章>相关文章</a></li></ul></nav></div></div></div></div></div><footer class="bg-white dark:bg-black border-gray-400 shadow mt-10"><div class="container mx-auto flex py-8"><div class="w-full text-center text-gray-600 dark:text-gray-400"><p>&copy; 2021 <a class="text-gray-700 dark:text-gray-300 font-semibold" href=https://blog.forecho.com>forecho's Blog</a> By forecho</p><p class=pt-1>Powered by <a rel="nofollow noreferer noopener" href=https://gohugo.io/ class="text-gray-700 dark:text-gray-300 font-semibold" target=_blank>Hugo</a>
Theme based on <a href=https://github.com/forecho/hugo-theme-echo class="text-gray-700 dark:text-gray-300 font-semibold" target=_blank>Echo</a></p><span id=busuanzi_container>访客数：<span id=busuanzi_value_site_uv></span> | 访问量 <span id=busuanzi_value_site_pv></span></span></div></div></footer><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-75634412-1','auto'),ga('send','pageview'))</script><script>var h,b,st,sh,progress,scroll,scrollpos,header,navcontent,lightIcon,darkIcon;window.onload=function(){var a,b,c;document.getElementById("nav-toggle").onclick=function(){document.getElementById("nav-content").classList.toggle("hidden")},a=document.getElementById("btn-donate"),a&&(a.onclick=function(){document.getElementById("donate-image").classList.remove("hidden"),a.classList.add("hidden")}),b=window.location.hostname,c=document.querySelectorAll('a[href^="http"]'),[].forEach.call(c,function(a){url=a.getAttribute("href");var c=url.replace("http://","").replace("https://","").split(/[/?#:]/)[0];c!==b&&a.setAttribute("target","_blank")})},h=document.documentElement,b=document.body,st="scrollTop",sh="scrollHeight",progress=document.querySelector("#progress"),scrollpos=window.scrollY,header=document.getElementById("header"),navcontent=document.getElementById("nav-content"),document.addEventListener("scroll",function(){scroll=(h[st]||b[st])/((h[sh]||b[sh])-h.clientHeight)*100,progress.style.setProperty("--scroll",scroll+"%"),scrollpos=window.scrollY,scrollpos>10?navcontent.classList.remove("bg-gray-100"):navcontent.classList.add("bg-gray-100")}),(localStorage.theme==='dark'||!1 in localStorage&&window.matchMedia('(prefers-color-scheme: dark)').matches)&&(lightIcon=document.getElementById("light-icon"),darkIcon=document.getElementById("dark-icon"),lightIcon.classList.add("hidden"),darkIcon.classList.remove("hidden"),document.querySelector('html').classList.add('dark')),document.getElementById('switchTheme').addEventListener('click',function(){var a,b;let c=document.querySelector('html').classList;a=document.getElementById("light-icon"),b=document.getElementById("dark-icon"),localStorage.theme=='dark'?(c.remove('dark'),localStorage.removeItem('theme'),b.classList.add("hidden"),a.classList.remove("hidden")):(c.add('dark'),a.classList.add("hidden"),b.classList.remove("hidden"),localStorage.theme='dark')})</script></body></html>